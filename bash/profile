#!/bin/bash

# Autoload includes
for includeFile in $(find "${HOME}/.wells_dotfiles/bash/includes" -type f ! -iname *.swp)
do
    . "${includeFile}"
done

EDITOR=vim
TZ=America/New_York
LANG=en_US.UTF-8
HISTFILE="${HOME}/.history"
HISTSIZE=1000

# auto enable colors for commands like 'ls'
CLICOLOR=1

export EDITOR TZ LANG HISTFILE HISTSIZE CLICOLOR

# Used by bash, unused by mksh
if [ "${0##*/}" = "bash" ] || [ "${0}" = "-bash" ] ; then
    shopt -s expand_aliases
    shopt -s checkwinsize
    HISTFILESIZE=2000
    HISTCONTROL=ignoredups:ignorespace
    export HISTFILESIZE HISTCONTROL
fi

if type -p rbenv >/dev/null 2>&1 ; then
    eval "$(rbenv init -)"
fi

# liquid prompt
source ~/.wells_dotfiles/bash/liquidprompt/liquidprompt

# Welcome Prompt
# source ~/.wells_dotfiles/bash/welcome_prompt.sh

# Load a local profile
[ -r "${HOME}/.localprofile" ] && . "${HOME}/.localprofile"


# automatically start tmux and pass along ssh credentials
if [ -z "$TMUX" ]; then
    # we're not in a tmux session

    if [ ! -z "$SSH_TTY" ]; then
        # We logged in via SSH

        # if ssh auth variable is missing
        if [ -z "$SSH_AUTH_SOCK" ]; then
            export SSH_AUTH_SOCK="$HOME/.ssh/.auth_socket"
        fi

        # if socket is available create the new auth session
        if [ ! -S "$SSH_AUTH_SOCK" ]; then
            `ssh-agent -a $SSH_AUTH_SOCK` > /dev/null 2>&1
            echo $SSH_AGENT_PID > $HOME/.ssh/.auth_pid
        fi

        # if agent isn't defined, recreate it from pid file
        if [ -z $SSH_AGENT_PID ]; then
            export SSH_AGENT_PID=`cat $HOME/.ssh/.auth_pid`
        fi

        # Add all default keys to ssh auth
        ssh-add 2>/dev/null

        # start tmux
        tmux -2 attach
    fi
fi

# for spotify.com website
export PATH=$PATH:/home/wells/src/web-site/Symfony/app
export PATH=$PATH:/home/wells/src/web-site-translations/Symfony/app
export PATH=$PATH:/home/wells/src/web-site-translations/Symfony/Symfony/app
export PATH=$PATH:/home/wells/src/web-site/Symfony/app/Symfony/app
export PATH=$PATH:/home/wells/Symfony/app
export PATH=$PATH:/home/wells/src/website/Symfony/app
export PATH=$PATH:/home/wells/src/website/Symfony/app
export PATH=$PATH:/home/wells/src/website/Symfony/app
